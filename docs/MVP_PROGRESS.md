# 每天吃点啥 - MVP 进度总结

## 当前阶段：MVP 核心功能开发中

---

## 一、已完成功能

### 后端 (Django + DRF)

| 模块 | 功能 | 状态 |
|------|------|------|
| **数据模型** | Recipe 食谱表 | ✅ |
| | Ingredient 食材表 | ✅ |
| | RecipeIngredient 关联表 | ✅ |
| **API 接口** | 食谱列表 `GET /recipes/` | ✅ |
| | 食谱详情 `GET /recipes/{id}/` | ✅ |
| | 推荐接口 `GET /recipes/recommend/` | ✅ |
| | 食材列表 `GET /ingredients/` | ✅ |
| | 食材详情 `GET /ingredients/{id}/` | ✅ |
| **筛选/搜索** | 按餐段筛选 (meal_type) | ✅ |
| | 按难度筛选 (difficulty) | ✅ |
| | 关键词搜索 (search) | ✅ |
| | 分页 (page/page_size) | ✅ |
| **数据导入** | Markdown 解析脚本 | ✅ |
| | 批量导入脚本 | ✅ |
| **管理后台** | Django Admin 配置 | ✅ |

**数据统计：**
- 食谱：327 条
- 食材：1928 条
- 有封面图：163 条

---

### 前端 (React Native + Expo)

| 模块 | 功能 | 状态 |
|------|------|------|
| **首页** | 卡片堆叠展示食谱 | ✅ |
| | 左滑切换下一道菜 | ✅ |
| | 点击边缘切换 | ✅ |
| | 封面图展示（含默认图） | ✅ |
| | 难度星级显示 | ✅ |
| | 餐段标签显示 | ✅ |
| | 下拉刷新换一批 | ✅ |
| **详情页** | 封面图展示 | ✅ |
| | 菜名/难度/耗时 | ✅ |
| | 食材清单（名称+用量） | ✅ |
| | 烹饪步骤（分步展示） | ✅ |
| | 小贴士展示 | ✅ |
| | 返回导航 | ✅ |
| **收藏** | 收藏按钮 UI | ✅ |
| | 本地状态管理 | ⚠️ 仅内存 |

---

## 二、未完成功能

### MVP 必须完成 (P0)

| 功能 | 当前状态 | 说明 |
|------|----------|------|
| **收藏持久化** | ❌ | 需接入 AsyncStorage 存储 |
| **收藏列表页** | ❌ | Tab Two 待开发 |（收藏功能通过存储于user表来实现）
| **按餐段分区展示** | ⚠️ 部分 | 当前为混合列表，需分早/中/晚 |（已实现，并支持随机推荐）
| **封面图静态服务** | ❌ | cover_url 存本地路径，后端需配置静态文件服务 |

### P1 功能（MVP 后优先）

| 功能 | 说明 |
|------|------|
| 按菜名搜索 | 前端搜索框 UI |
| 口味偏好 | 本地存储偏好设置 |
| 难度筛选 | 前端筛选 UI |

### P2 功能（后续迭代）

| 功能 | 说明 |
|------|------|
| 冰箱反查 | 根据食材查菜谱 |
| 购物清单 | 汇总食材生成清单 |
| 营养计算 | 调用 AI 填充营养数据 |

---

## 三、下一步实施计划

### 阶段 1：完成 MVP 核心

1. **收藏功能持久化**
   - 前端接入 `@react-native-async-storage/async-storage`
   - 实现收藏/取消收藏本地存储
   - 开发收藏列表页 (Tab Two)

2. **封面图服务**
   - Django 配置 `MEDIA_URL` 和 `STATICFILES_DIRS`
   - 将 `recipes_data` 目录作为静态资源挂载
   - 或：图片上传至 CDN，数据库存完整 URL

3. **首页按餐段分区**
   - 调用 `/recipes/recommend/?meal_type=xxx` 三次
   - 分区块展示：早餐 / 午餐 / 晚餐

### 阶段 2：体验优化

4. **Tab 栏定制**
   - 修改 `_layout.tsx`，设置合适的图标和标题
   - 首页："推荐" / 收藏页："我的收藏"

5. **搜索功能**
   - 添加搜索框组件
   - 调用 `/recipes/?search=xxx`

---

## 四、技术债务

| 项目 | 说明 |
|------|------|
| API_BASE_URL 硬编码 | 需抽取为环境变量 |
| 错误处理 | 需统一错误提示 UI |
| 加载状态 | 骨架屏/占位符优化 |
| TypeScript 类型 | 部分类型需完善 |
| 无图菜谱封面 | 163/327 有图，建议优化 `find_cover_image` 逻辑 |

---

## 五、项目结构

```
whatToEatToday/
├── backend/                 # Django 后端
│   ├── apps/
│   │   ├── recipes/         # 食谱模块
│   │   ├── ingredients/     # 食材模块
│   │   └── users/           # 用户模块（预留）
│   ├── config/              # Django 配置
│   └── db.sqlite3           # SQLite 数据库
├── frontend/                # React Native 前端
│   └── app/
│       ├── (tabs)/          # Tab 页面
│       │   ├── index.tsx    # 首页（卡片推荐）
│       │   └── two.tsx      # Tab2（待开发收藏页）
│       └── recipe/
│           └── [id].tsx     # 详情页
├── scripts/                 # 数据处理脚本
│   ├── parse_markdown.py    # Markdown 解析
│   └── import_recipes.py    # 数据导入
├── recipes_data/            # 菜谱原始数据
└── docs/                    # 文档
```

---

*更新时间：2026-01-21*
